
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>DRfC (Deepracer for Cloud) &#8212; AWS Deepracer School</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Resources" href="07_Resources.html" />
    <link rel="prev" title="Auto Submit" href="05_Auto_Submit.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">AWS Deepracer School</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    AWS Deepracer School
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../About_Dolphin.html">
   About Dolphin
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basic Course
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../What_is_AWS_DeepRacer/01_%EC%84%B9%EC%85%98%EC%86%8C%EA%B0%9C.html">
   AWS Deepracer 란
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../What_is_AWS_DeepRacer/02_DeepRacer%EB%9E%80.html">
     DeepRacer 란?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../What_is_AWS_DeepRacer/03_%EB%B0%B0%EC%9A%B8%EC%88%98_%EC%9E%88%EB%8A%94%EA%B2%83.html">
     배울 수 있는 것
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../What_is_AWS_DeepRacer/04_%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C_%EC%BB%B4%ED%93%A8%ED%8C%85%EA%B3%BC_AWS.html">
     클라우드 컴퓨팅과 AWS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../What_is_AWS_DeepRacer/05_DeepRacer_%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C%EC%9A%B0.html">
     Deepracer 워크플로우
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../What_is_AWS_DeepRacer/06_DeepRacer_%EC%9E%91%EB%8F%99%EC%9B%90%EB%A6%AC.html">
     Deepracer 작동원리
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../What_is_AWS_DeepRacer/07_DeepRacer_%EC%9A%94%EA%B8%88_%EC%A0%95%EC%B1%85.html">
     Deepracer 요금 정책
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../AWS_Account/01_%EC%84%B9%EC%85%98%EC%86%8C%EA%B0%9C.html">
   AWS 계정 및 가입
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../AWS_Account/07_AWS_%EA%B0%80%EC%9E%85.html">
     AWS 가입
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../AWS_Account/08_AWS_%EA%B3%84%EC%A0%95_%EC%84%A4%EC%A0%95.html">
     AWS 계정 설정
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../DeepRacer_Console/01_%EC%84%B9%EC%85%98%EC%86%8C%EA%B0%9C.html">
   Deepracer Console
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../DeepRacer_Console/02_DeepRacer_%EC%BD%98%EC%86%94_%EB%91%98%EB%9F%AC%EB%B3%B4%EA%B8%B0.html">
     Deepracer 콘솔 둘러보기
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DeepRacer_Console/03_Racing_League.html">
     Racing_League
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Model_Training/01_%EC%84%B9%EC%85%98%EC%86%8C%EA%B0%9C.html">
   Model_Training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Reinforcement_Learning/01_%EC%84%B9%EC%85%98%EC%86%8C%EA%B0%9C.html">
   Reinforcement Learning
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Python_for_DeepRacer/01_%EC%84%B9%EC%85%98%EC%86%8C%EA%B0%9C.html">
   Python for Deepracer
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Python_for_DeepRacer/02_python%EA%B3%BC_colab.html">
     Python과 Colab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Python_for_DeepRacer/03_%EC%B6%9C%EB%A0%A5%EA%B3%BC_%EB%B3%80%EC%88%98.html">
     출력과 변수
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Python_for_DeepRacer/04_%EC%9E%90%EB%A3%8C%ED%98%95.html">
     자료형
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Python_for_DeepRacer/05_%EC%97%B0%EC%82%B0.html">
     연산
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Python_for_DeepRacer/06_%EB%A6%AC%EC%8A%A4%ED%8A%B8_%EB%8B%A4%EB%A3%A8%EA%B8%B0.html">
     리스트 다루기
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Python_for_DeepRacer/07_math_%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC.html">
     math Library
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Python_for_DeepRacer/08_if_%EC%A1%B0%EA%B1%B4%EB%AC%B8.html">
     if 조건문
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Python_for_DeepRacer/09_for_%EB%B0%98%EB%B3%B5%EB%AC%B8.html">
     for 반복문
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Python_for_DeepRacer/10_while_%EC%A1%B0%EA%B1%B4%EB%B0%98%EB%B3%B5%EB%AC%B8.html">
     while 조건반복문
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Python_for_DeepRacer/11_%ED%95%A8%EC%88%98.html">
     함수
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Reward_Function/01_%EC%84%B9%EC%85%98%EC%86%8C%EA%B0%9C.html">
   Reward Function
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reward_Function/02_params.html">
     params
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reward_Function/03_Default_examples.html">
     기본 보상함수 예제
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reward_Function/04_Reward_function_Lab.html">
     보상함수 실험
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reward_Function/05_Track_Visualization.html">
     Track 시각화
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Log_Analysis/01_%EC%84%B9%EC%85%98%EC%86%8C%EA%B0%9C.html">
   Log Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Log_Analysis/02_Reward_graph.html">
     Reward graph
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Log_Analysis/03_download_logs.html">
     download logs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Log_Analysis/04_iteration_csv_file.html">
     iteration csv 파일 다루기
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Log_Analysis/05_print_all_params.html">
     모든 params 출력하기
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Physical_Car/01_%EC%84%B9%EC%85%98%EC%86%8C%EA%B0%9C.html">
   Physical Car
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="01_%EC%84%B9%EC%85%98%EC%86%8C%EA%B0%9C.html">
   Etc
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="02_DeepRacer_Student.html">
     DeepRacer Student
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_Import_and_Export_Model.html">
     Import and Export Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_multi_user_mode.html">
     Multi-User Mode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05_Auto_Submit.html">
     Auto Submit
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     DRfC (Deepracer for Cloud)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07_Resources.html">
     Resources
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Basic/Tips/06_DRfC.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/Basic/Tips/06_DRfC.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   개요
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#link">
     관련 Link
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aws-instance">
     AWS instance 정보 비교
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#service-quotas">
     Service Quotas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     사전 준비 사항
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ami">
   1. AMI 등록
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     (1-1) 인스턴스 생성
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ssh">
     (1-2) 인스턴스 ssh 연결
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     (1-3) 필수 구성요소 설치  (로컬에서는 하지 않는게 좋음)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     (1-4)  재부팅
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     (1-5) 인스턴스 ssh 재연결
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#docker">
     (1-6) 전체 리포지토리 설정 및 핵심 Docker 이미지 다운로드
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     (1-7) 유틸리티 설치
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     (1-8) AMI 등록 및 인스턴스 종료
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#environment-setup">
   2. Environment Setup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ubuntu">
     (2-1) ubuntu 사용자 전환
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     (2-2) 작업폴더 이동 및 명령어 가져오기
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s3">
     (2-3) S3 버킷 설정
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     (2-4) 모델 목록 확인
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     (2-5) 모델 설정
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-metadata-json">
     (2-6) model_metadata.json
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reward-functino-py">
     (2-7) reward_functino.py
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hyperparameters-json">
     (2-8) hyperparameters.json
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#worker">
     (2-9) worker 설정
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run">
   3. RUN
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tmux">
     tmux
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     실행
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#robomaker">
     robomaker 모니터링
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     기타
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>DRfC (Deepracer for Cloud)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   개요
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#link">
     관련 Link
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aws-instance">
     AWS instance 정보 비교
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#service-quotas">
     Service Quotas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     사전 준비 사항
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ami">
   1. AMI 등록
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     (1-1) 인스턴스 생성
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ssh">
     (1-2) 인스턴스 ssh 연결
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     (1-3) 필수 구성요소 설치  (로컬에서는 하지 않는게 좋음)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     (1-4)  재부팅
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     (1-5) 인스턴스 ssh 재연결
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#docker">
     (1-6) 전체 리포지토리 설정 및 핵심 Docker 이미지 다운로드
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     (1-7) 유틸리티 설치
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     (1-8) AMI 등록 및 인스턴스 종료
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#environment-setup">
   2. Environment Setup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ubuntu">
     (2-1) ubuntu 사용자 전환
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     (2-2) 작업폴더 이동 및 명령어 가져오기
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#s3">
     (2-3) S3 버킷 설정
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     (2-4) 모델 목록 확인
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     (2-5) 모델 설정
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-metadata-json">
     (2-6) model_metadata.json
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reward-functino-py">
     (2-7) reward_functino.py
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hyperparameters-json">
     (2-8) hyperparameters.json
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#worker">
     (2-9) worker 설정
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run">
   3. RUN
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tmux">
     tmux
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     실행
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#robomaker">
     robomaker 모니터링
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     기타
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="drfc-deepracer-for-cloud">
<h1>DRfC (Deepracer for Cloud)<a class="headerlink" href="#drfc-deepracer-for-cloud" title="Permalink to this headline">#</a></h1>
<section id="id1">
<h2>개요<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>DRfC(Deepracer for Cloud)는 딥레이서를 콘솔이 아닌 클라우드 및 로컬에서 훈련시키는 것을 말합니다.</p></li>
<li><p>이러한 방식은 훈련 비용 절감 및 자유도가 높은 훈련 환경을 제공합니다.</p></li>
<li><p>특히, 이 강의에서는 AWS Spot Instance를 활용한 모델 훈련 방법에 대해 소개합니다.</p>
<ul>
<li><p>Spot Instance 란, 경매 방식으로 EC2의 남는 자원을 저렴한 비용으로 이용하는 것을 말합니다.</p></li>
</ul>
</li>
<li><p>AWS EC2, S3, Ubuntu, Docker 등 다양한 배경지식이 필요로 합니다.</p></li>
</ul>
<section id="link">
<h3>관련 Link<a class="headerlink" href="#link" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://aws-deepracer-community.github.io/deepracer-for-cloud/">DRfC 메인 사이트</a></p></li>
<li><p><a class="reference external" href="https://hub.docker.com/u/awsdeepracercommunity">DRfC Docker</a></p></li>
<li><p><a class="reference external" href="https://aws.amazon.com/ko/ec2/spot/pricing">spot instacne 비용</a></p></li>
</ul>
</section>
<section id="aws-instance">
<h3>AWS instance 정보 비교<a class="headerlink" href="#aws-instance" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>spot price (변동)</p></th>
<th class="head"><p>vCPU</p></th>
<th class="head"><p>Memory</p></th>
<th class="head"><p>GPU</p></th>
<th class="head"><p>동시훈련 가능 수</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>c5.2xlarge</p></td>
<td><p>$0.173</p></td>
<td><p>8</p></td>
<td><p>16GB</p></td>
<td><p></p></td>
<td><p>1개</p></td>
</tr>
<tr class="row-odd"><td><p>c5.4xlarge</p></td>
<td><p>$0.268</p></td>
<td><p>16</p></td>
<td><p>32GB</p></td>
<td><p></p></td>
<td><p>3개</p></td>
</tr>
<tr class="row-even"><td><p>g4dn.2xlarge</p></td>
<td><p>$0.2256</p></td>
<td><p>8</p></td>
<td><p>32GB</p></td>
<td><p>T4 16GB</p></td>
<td><p>1개</p></td>
</tr>
<tr class="row-odd"><td><p>g4dn.4xlarge</p></td>
<td><p>$0.3612</p></td>
<td><p>16</p></td>
<td><p>64GB</p></td>
<td><p>T4 16GB</p></td>
<td><p>3개</p></td>
</tr>
<tr class="row-even"><td><p>g4dn.8xlarge</p></td>
<td><p>$0.6528</p></td>
<td><p>32</p></td>
<td><p>128GB</p></td>
<td><p>T4 16GB</p></td>
<td><p>8개</p></td>
</tr>
</tbody>
</table>
</section>
<section id="service-quotas">
<h3>Service Quotas<a class="headerlink" href="#service-quotas" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>GPU 인스턴스를 활용하면 훈련 속도가 훨씬 더 빠릅니다.</p></li>
<li><p>그러나 AWS 개인 계정의 경우 GPU 인스턴스를 spot(경매) 방식으로 요청할 수 있는 할당량이 주어져있지 않습니다.</p></li>
<li><p>만약, 개인 게정에서 GPU 인스턴스를 spot(경매) 요청을 하고자 한다면 Service Quotas 에서 할당량 증가를 요청해야 합니다.</p>
<ul>
<li><p>Service Quotas &gt; AWS 서비스 &gt; EC2 &gt; All G and VT Spot Instance Requests &gt; 할당량 증가 요청 &gt; 할당량 값 변경 (32개 정도면 충분)</p></li>
</ul>
</li>
<li><p>할당량 증가 요청을 하면 검토 후 승인이 나야합니다. 그러나 승인이 거절되는 경우가 많습니다.</p></li>
<li><p>따라서 이 강의에서는 CPU 인스턴스를 활용하여 실습을 진행합니다.</p></li>
</ul>
</section>
<section id="id2">
<h3>사전 준비 사항<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>S3 버킷 생성 (2개) –region us-east-1</p>
<ul>
<li><p>local 용도의 버킷 (예) drfc-….-local</p></li>
<li><p>upload 용도의 버킷 (예) drfc-….-upload</p></li>
</ul>
</li>
<li><p>EC2 Role 생성</p>
<ul>
<li><p>S3 FullAccess</p></li>
</ul>
</li>
<li><p>Security Group 생성</p>
<ul>
<li><p>SSH : 22</p></li>
<li><p>Web Monitoring : 8080-8100</p></li>
<li><p>~~VNC : 5900-5910~~</p></li>
<li><p>~~Jupyter : 8888~~</p></li>
</ul>
</li>
<li><p>키페어 생성</p></li>
</ul>
</section>
</section>
<section id="ami">
<h2>1. AMI 등록<a class="headerlink" href="#ami" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>기본적으로 설치해야 할 것들이 많습니다.</p></li>
<li><p>매번 인스턴스를 켜서 새로 설치하는 것은 번거로운 일이기 때문에 AMI 를 등록해 놓는 것이 좋습니다.</p></li>
<li><p>특히, Spot(경매)의 경우 언제든 인스턴스가 종료 될 수 있기 때문에 이러한 과정은 반드시 필요합니다.</p></li>
</ul>
<section id="id3">
<h3>(1-1) 인스턴스 생성<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>리전 : us-east-1 (버지니아 북부)</p></li>
<li><p>AMI : ubuntu20.04</p></li>
<li><p>보안그룹 포트</p>
<ul>
<li><p>SSH : 22</p></li>
<li><p>VNC : 5900-5910</p></li>
<li><p>Web Monitoring : 8080-8100</p></li>
<li><p>Jupyter : 8888</p></li>
</ul>
</li>
<li><p>스토리지 : 40 GB gp2</p></li>
<li><p>Spot 인스턴스</p></li>
<li><p>EC2 Role : S3 FullAccess</p></li>
</ul>
</section>
<section id="ssh">
<h3>(1-2) 인스턴스 ssh 연결<a class="headerlink" href="#ssh" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EC2</span> <span class="pre">인스턴스</span> <span class="pre">연결</span></code>을 통해 웹브라우저 상에서 ssh 접속이 가능합니다.</p></li>
</ul>
</section>
<section id="id4">
<h3>(1-3) 필수 구성요소 설치  (로컬에서는 하지 않는게 좋음)<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 사용자 홈 디렉토리 이동</span>
<span class="nb">cd</span><span class="w"> </span>~

<span class="c1"># DRfC git 레파지토리 클론</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/aws-deepracer-community/deepracer-for-cloud.git

<span class="c1"># 작어폴더 이동</span>
<span class="nb">cd</span><span class="w"> </span>~/deepracer-for-cloud

<span class="c1"># 드라이브 분할 및 필수 구성 요소 설치 </span>
./bin/prepare.sh
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id5">
<h3>(1-4)  재부팅<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>reboot<span class="w"> </span>now
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id6">
<h3>(1-5) 인스턴스 ssh 재연결<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
</section>
<section id="docker">
<h3>(1-6) 전체 리포지토리 설정 및 핵심 Docker 이미지 다운로드<a class="headerlink" href="#docker" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 작업폴더 이동</span>
<span class="nb">cd</span><span class="w"> </span>~/deepracer-for-cloud

<span class="c1"># 전체 리포지토리 설정 및 핵심 Docker 이미지 다운로드 </span>
./bin/init.sh<span class="w"> </span>-c<span class="w"> </span>aws<span class="w"> </span>-a<span class="w"> </span>cpu
</pre></div>
</div>
<ul class="simple">
<li><p>인스턴스 옵션 : <code class="docutils literal notranslate"><span class="pre">cpu</span></code> 또는 <code class="docutils literal notranslate"><span class="pre">gpu</span></code></p></li>
</ul>
</li>
</ul>
</section>
<section id="id7">
<h3>(1-7) 유틸리티 설치<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>tmux (백그라운드 다중 터미널 도구)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># nmon 설치</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>tmux
</pre></div>
</div>
</li>
<li><p>nmon (Linux 운영 체제용 컴퓨터 성능 시스템 모니터 도구)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># nmon 설치</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>nmon
</pre></div>
</div>
</li>
<li><p>gpustat 설치 (GPU 모니터링)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># pip 인스톨</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>python3-pip
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># gpustat 설치</span>
pip3<span class="w"> </span>install<span class="w"> </span>gpustat
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id8">
<h3>(1-8) AMI 등록 및 인스턴스 종료<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>(1-5)에서 cpu 옵션일 때와 gpu 옵션일 때 설치 구성요소가 다릅니다.</p></li>
<li><p>따라서 cpu를 사용할 때와 gpu를 사용할 때 AMI 를 따로 등록해야 합니다.</p></li>
<li><p>AMI 등록이 완료되면 현재 인스턴스는 종료합니다.</p></li>
</ul>
</section>
</section>
<section id="environment-setup">
<h2>2. Environment Setup<a class="headerlink" href="#environment-setup" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>우선, 등록한 AMI 로 Spot 인스턴스를 생성합니다.</p></li>
</ul>
<section id="ubuntu">
<h3>(2-1) ubuntu 사용자 전환<a class="headerlink" href="#ubuntu" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>su<span class="w"> </span>-<span class="w"> </span>ubuntu
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id9">
<h3>(2-2) 작업폴더 이동 및 명령어 가져오기<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 작업폴더이동</span>
<span class="nb">cd</span><span class="w"> </span>~/deepracer-for-cloud/

<span class="c1"># dr-* 명령어 가져오기</span>
<span class="nb">source</span><span class="w"> </span>bin/activate.sh
</pre></div>
</div>
</li>
</ul>
</section>
<section id="s3">
<h3>(2-3) S3 버킷 설정<a class="headerlink" href="#s3" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">############## 주요 환경변수 설정 ##############</span>
<span class="c1"># S3 버킷 (로컬 및 업로드)</span>
<span class="nv">DR_LOCAL_S3_BUCKET</span><span class="o">=</span>drfc-....-local
<span class="nv">DR_UPLOAD_S3_BUCKET</span><span class="o">=</span>drfc-....-upload

<span class="c1"># # 버킷 생성</span>
<span class="c1"># aws s3 mb s3://${DR_LOCAL_S3_BUCKET} --region us-east-1</span>
<span class="c1"># aws s3 mb s3://${DR_UPLOAD_S3_BUCKET} --region us-east-1</span>

<span class="c1"># 환경변수 등록</span>
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/\(^DR_LOCAL_S3_BUCKET=\)\(.*\)/\1</span><span class="nv">$DR_LOCAL_S3_BUCKET</span><span class="s2">/&quot;</span><span class="w"> </span>system.env
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/\(^DR_UPLOAD_S3_BUCKET=\)\(.*\)/\1</span><span class="nv">$DR_UPLOAD_S3_BUCKET</span><span class="s2">/&quot;</span><span class="w"> </span>system.env
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id10">
<h3>(2-4) 모델 목록 확인<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">############## 모델 목록 확인 ##############</span>
aws<span class="w"> </span>s3<span class="w"> </span>ls<span class="w"> </span>s3://<span class="si">${</span><span class="nv">DR_LOCAL_S3_BUCKET</span><span class="si">}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id11">
<h3>(2-5) 모델 설정<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 모델명 (폴더명)</span>
<span class="nv">DR_LOCAL_S3_MODEL_PREFIX</span><span class="o">=</span>mymodel-2

<span class="c1"># 모델 Clone</span>
<span class="nv">DR_LOCAL_S3_PRETRAINED</span><span class="o">=</span>False<span class="w">  </span><span class="c1"># Clone 여부</span>
<span class="nv">DR_LOCAL_S3_PRETRAINED_PREFIX</span><span class="o">=</span>mymodel-1<span class="w"> </span><span class="c1"># Clone 할 모델명</span>

<span class="c1"># 동시 작업</span>
<span class="nv">DR_WORKERS</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="c1"># 동시 훈련 로보메이커 수</span>

<span class="c1"># 다중 작업 구성</span>
<span class="nv">DR_DOCKER_STYLE</span><span class="o">=</span>compose<span class="w"> </span><span class="c1"># docker compose or swarm</span>

<span class="c1"># 환경변수 등록</span>
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/\(^DR_LOCAL_S3_MODEL_PREFIX=\)\(.*\)/\1</span><span class="nv">$DR_LOCAL_S3_MODEL_PREFIX</span><span class="s2">/&quot;</span><span class="w"> </span>run.env
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/\(^DR_LOCAL_S3_PRETRAINED=\)\(.*\)/\1</span><span class="nv">$DR_LOCAL_S3_PRETRAINED</span><span class="s2">/&quot;</span><span class="w"> </span>run.env
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/\(^DR_LOCAL_S3_PRETRAINED_PREFIX=\)\(.*\)/\1</span><span class="nv">$DR_LOCAL_S3_PRETRAINED_PREFIX</span><span class="s2">/&quot;</span><span class="w"> </span>run.env
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/\(^DR_DOCKER_STYLE=\)\(.*\)/\1</span><span class="nv">$DR_DOCKER_STYLE</span><span class="s2">/&quot;</span><span class="w"> </span>system.env
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/\(^DR_WORKERS=\)\(.*\)/\1</span><span class="nv">$DR_WORKERS</span><span class="s2">/&quot;</span><span class="w"> </span>system.env
</pre></div>
</div>
</li>
</ul>
</section>
<section id="model-metadata-json">
<h3>(2-6) model_metadata.json<a class="headerlink" href="#model-metadata-json" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">############# model_metadata.json ###########</span>
cat<span class="w"> </span><span class="s">&lt;&lt;EOF &gt;./custom_files/model_metadata.json</span>
<span class="s">{</span>
<span class="s">  &quot;action_space&quot; : {</span>
<span class="s">    &quot;steering_angle&quot; : {</span>
<span class="s">      &quot;high&quot; : 30.0,</span>
<span class="s">      &quot;low&quot; : -30.0</span>
<span class="s">    },</span>
<span class="s">    &quot;speed&quot; : {</span>
<span class="s">      &quot;high&quot; : 1.0,</span>
<span class="s">      &quot;low&quot; : 0.5</span>
<span class="s">    }</span>
<span class="s">  },</span>
<span class="s">  &quot;sensor&quot;: [&quot;FRONT_FACING_CAMERA&quot;],</span>
<span class="s">  &quot;neural_network&quot;: &quot;DEEP_CONVOLUTIONAL_NETWORK_SHALLOW&quot;,</span>
<span class="s">  &quot;training_algorithm&quot;: &quot;clipped_ppo&quot;, </span>
<span class="s">  &quot;action_space_type&quot;: &quot;continuous&quot;,</span>
<span class="s">  &quot;version&quot;: &quot;4&quot;</span>
<span class="s">}</span>
<span class="s">EOF</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="reward-functino-py">
<h3>(2-7) reward_functino.py<a class="headerlink" href="#reward-functino-py" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">############## reward_function.py ###############</span>
cat<span class="w"> </span><span class="s">&lt;&lt;EOF &gt;./custom_files/reward_function.py</span>
<span class="s">def reward_function(params):</span>
<span class="s">    # Read input parameters</span>
<span class="s">    track_width = params[&#39;track_width&#39;]</span>
<span class="s">    distance_from_center = params[&#39;distance_from_center&#39;]</span>
<span class="s">    </span>
<span class="s">    # Calculate 3 markers that are at varying distances away from the center line</span>
<span class="s">    marker_1 = 0.1 * track_width</span>
<span class="s">    marker_2 = 0.25 * track_width</span>
<span class="s">    marker_3 = 0.5 * track_width</span>
<span class="s">    </span>
<span class="s">    # Give higher reward if the car is closer to center line and vice versa</span>
<span class="s">    if distance_from_center &lt;= marker_1:</span>
<span class="s">        reward = 1.0</span>
<span class="s">    elif distance_from_center &lt;= marker_2:</span>
<span class="s">        reward = 0.5</span>
<span class="s">    elif distance_from_center &lt;= marker_3:</span>
<span class="s">        reward = 0.1</span>
<span class="s">    else:</span>
<span class="s">        reward = 1e-3  # likely crashed/ close to off track</span>
<span class="s">    return float(reward)</span>
<span class="s">EOF</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="hyperparameters-json">
<h3>(2-8) hyperparameters.json<a class="headerlink" href="#hyperparameters-json" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">############# hyperparameters.json ############</span>
cat<span class="w"> </span><span class="s">&lt;&lt;EOF &gt;./custom_files/hyperparameters.json</span>
<span class="s">{</span>
<span class="s">    &quot;batch_size&quot;: 128,</span>
<span class="s">    &quot;beta_entropy&quot;: 0.01,</span>
<span class="s">    &quot;discount_factor&quot;: 0.999,</span>
<span class="s">    &quot;e_greedy_value&quot;: 0.05,</span>
<span class="s">    &quot;epsilon_steps&quot;: 10000,</span>
<span class="s">    &quot;exploration_type&quot;: &quot;categorical&quot;,</span>
<span class="s">    &quot;loss_type&quot;: &quot;huber&quot;,</span>
<span class="s">    &quot;lr&quot;: 0.00015,</span>
<span class="s">    &quot;num_episodes_between_training&quot;: 60,</span>
<span class="s">    &quot;num_epochs&quot;: 10,</span>
<span class="s">    &quot;stack_size&quot;: 1,</span>
<span class="s">    &quot;term_cond_avg_score&quot;: 100000.0,</span>
<span class="s">    &quot;term_cond_max_episodes&quot;: 100000,</span>
<span class="s">    &quot;sac_alpha&quot;: 0.2</span>
<span class="s">  }</span>
<span class="s">EOF</span>
</pre></div>
</div>
<ul class="simple">
<li><p>주의 : <code class="docutils literal notranslate"><span class="pre">num_episodes_between_training</span></code> 는 모든 Worker에 대한 값이다. 단일 작업에서 설정한 값에 워커 수만큼 곱해줘야 한다.</p></li>
<li><p>추가적으로 run.env 에서 <code class="docutils literal notranslate"><span class="pre">DR_TRAIN_ROUND_ROBIN_ADVANCE_DIST</span></code> 환경변수는 아래와 같이 값을 맞춰줘야 한다.<br />
<code class="docutils literal notranslate"><span class="pre">num_episodes_between_training</span> <span class="pre">/</span> <span class="pre">DR_WORKERS</span></code></p></li>
</ul>
</li>
</ul>
</section>
<section id="worker">
<h3>(2-9) worker 설정<a class="headerlink" href="#worker" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">################ Worker 설정 ################</span>
<span class="c1">#### 메인 worker ####</span>
<span class="nv">DR_TRAIN_MULTI_CONFIG</span><span class="o">=</span>False<span class="w"> </span><span class="c1"># 서브 Worker 따로 환경 설정할 지 여부</span>

<span class="nv">DR_WORLD_NAME</span><span class="o">=</span>FS_June2020<span class="w"> </span><span class="c1"># 트랙명</span>
<span class="nv">DR_RACE_TYPE</span><span class="o">=</span>TIME_TRIAL<span class="w"> </span><span class="c1"># 레이싱 유형</span>

sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/\(^DR_TRAIN_MULTI_CONFIG=\)\(.*\)/\1</span><span class="nv">$DR_TRAIN_MULTI_CONFIG</span><span class="s2">/&quot;</span><span class="w"> </span>run.env
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/\(^DR_WORLD_NAME=\)\(.*\)/\1</span><span class="nv">$DR_WORLD_NAME</span><span class="s2">/&quot;</span><span class="w"> </span>run.env
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/\(^DR_RACE_TYPE=\)\(.*\)/\1</span><span class="nv">$DR_RACE_TYPE</span><span class="s2">/&quot;</span><span class="w"> </span>run.env
</pre></div>
</div>
<ul class="simple">
<li><p>트랙명은 아래 사이트에서 참조 (<code class="docutils literal notranslate"><span class="pre">트랙명.npy</span></code>)<br />
<a class="reference external" href="https://github.com/aws-deepracer-community/deepracer-race-data/tree/main/raw_data/tracks">https://github.com/aws-deepracer-community/deepracer-race-data/tree/main/raw_data/tracks</a></p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="run">
<h2>3. RUN<a class="headerlink" href="#run" title="Permalink to this headline">#</a></h2>
<section id="tmux">
<h3>tmux<a class="headerlink" href="#tmux" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>백그라운드 및 다중 터미널 분할</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># tmux 실행</span>
tmux
</pre></div>
</div>
</li>
<li><p>tmux 명령어 및 단축키</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tmux</span> <span class="pre">new</span> <span class="pre">-s</span> <span class="pre">&lt;session-name&gt;</span></code> : 지정한 세션 명으로 세션 시작</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tmux</span> <span class="pre">ls</span></code> : 세션 목록 확인</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tmux</span> <span class="pre">attach</span> <span class="pre">-t</span> <span class="pre">&lt;session-name&gt;</span></code> : 세션 접속</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ctrl+b</span></code>, <code class="docutils literal notranslate"><span class="pre">%</span></code> : 터미널 세로 분할</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ctrl+b</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> : 터미널 가로 분할</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ctrl+b</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code> : 세션 빠져나오기</p></li>
</ul>
</li>
</ul>
</section>
<section id="id12">
<h3>실행<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h3>
<ul>
<li><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure 업데이트</span>
dr-update

<span class="c1"># custom 업데이트</span>
dr-upload-custom-files

<span class="c1"># 혹시 기존에 실행중인 터미널 있다면 종료하기</span>
dr-stop-training<span class="w"> </span>

<span class="c1"># 훈련 시작</span>
dr-start-training<span class="w"> </span>-w
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-w</span></code> (wipes) 옵션은 모델명이 있는 폴더에 데이터가 존재하면 제거하는 옵션</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sagemaker</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">running</span></code> 에러 발생 시</p>
<ul>
<li><p>일시적 오류이다. 아래 명령어를 통해 다시 시도한다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dr-stop-training</span> <span class="pre">&amp;&amp;</span> <span class="pre">dr-start-training</span> <span class="pre">-w</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Selected</span> <span class="pre">path</span> <span class="pre">s3://your_bucket/your_model.</span> <span class="pre">Delete</span> <span class="pre">it,</span> <span class="pre">or</span> <span class="pre">use</span> <span class="pre">-w</span> <span class="pre">option.</span> <span class="pre">Exiting.</span></code> 에러 발생 시</p>
<ul>
<li><p>버킷안에 이미 지정한 모델명으로 된 폴더가 존재하여 발생하는 에러.</p></li>
<li><p>해당 모델명 폴더를 삭제하거나 <code class="docutils literal notranslate"><span class="pre">-w</span></code> 옵션을 줘서 자동으로 삭제되도록 한다.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="robomaker">
<h3>robomaker 모니터링<a class="headerlink" href="#robomaker" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>개별 모니터링</p>
<ul class="simple">
<li><p>개별 포트는 8080~8089 사이로 자동 할당 됨</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">ps</span></code> 명령어를 통해 할당 된 포트를 확인 가능</p></li>
<li><p>개별 모니터링 접속 : <code class="docutils literal notranslate"><span class="pre">http://ip주소:개별port</span></code></p></li>
</ul>
</li>
<li><p>전체 모니터링</p>
<ul>
<li><p>robomaker 모니터링 컨테이너 실행</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 뷰어 중지 (기존에 떠있는 뷰어 컨테이너 종료)</span>
dr-stop-viewer

<span class="c1"># 뷰어 컨테이너 실행</span>
dr-start-viewer
</pre></div>
</div>
</li>
<li><p>전체 모니터링 접속: <code class="docutils literal notranslate"><span class="pre">http://ip주소:8100</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">http://ip주소:8100/?robo=all&amp;camera=kvs_stream&amp;quality=75&amp;width=480</span></code></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="id13">
<h3>기타<a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">dr-increment-training</span> <span class="pre">-f</span></code></p>
<ul>
<li><p>모델명 뒤의 <code class="docutils literal notranslate"><span class="pre">-숫자</span></code>를 하나 더하여 클론 훈련 진행</p></li>
<li><p>(예) 현재 모델명이 <code class="docutils literal notranslate"><span class="pre">test-1</span></code> 으로 훈련중일 때, 아래와 같이 명령어를 작성하면 <code class="docutils literal notranslate"><span class="pre">test-2</span></code>로 클론한 모델이 훈련 됨.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dr-stop-training
dr-increment-training<span class="w"> </span>-f
dr-update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>dr-upload-custom-files<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>dr-start-training<span class="w"> </span>-w
</pre></div>
</div>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">dr-upload-model</span></code></p>
<ul class="simple">
<li><p>현재 훈련중인 마지막 모델을 업로드 버킷으로 업로드</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-b</span></code> 옵션을 주면 최상위 모델을 업로드</p></li>
</ul>
</li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Basic/Tips"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="05_Auto_Submit.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Auto Submit</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="07_Resources.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Resources</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By dongorae (fanfrebird@naver.com)<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>